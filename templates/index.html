<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weapon Tracking Panel</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; padding: 20px; color: #333; }
        .container { max-width: 1000px; margin: 0 auto; }

        /* Header Area */
        header { text-align: center; margin-bottom: 40px; }
        h1 { margin: 0; color: #2c3e50; }
        p.subtitle { color: #7f8c8d; }

        /* Grid Structure (2x2) */
        .actions-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 40px; }

        .card { background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); border-top: 5px solid #ccc; }

        /* Card Colors */
        .card-mint { border-top-color: #27ae60; }
        .card-transfer { border-top-color: #2980b9; }
        .card-maintenance { border-top-color: #f39c12; }
        .card-report { border-top-color: #c0392b; }

        input[type="text"], select { width: 100%; padding: 10px; margin: 10px 0 20px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
        label { font-weight: bold; font-size: 0.9em; }

        button { width: 100%; padding: 12px; border: none; color: white; font-weight: bold; border-radius: 5px; cursor: pointer; transition: 0.3s; }

        /* Button Colors */
        .btn-mint { background-color: #27ae60; }
        .btn-mint:hover { background-color: #219150; }

        .btn-transfer { background-color: #2980b9; }
        .btn-transfer:hover { background-color: #1f618d; }

        .btn-maintenance { background-color: #f39c12; }
        .btn-maintenance:hover { background-color: #d35400; }

        .btn-report { background-color: #c0392b; }
        .btn-report:hover { background-color: #922b21; }

        /* Inventory Table */
        .inventory-section { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background-color: #34495e; color: white; padding: 12px; text-align: left; }
        td { padding: 12px; border-bottom: 1px solid #eee; }
        tr:hover { background-color: #f9f9f9; }

        .badge { padding: 4px 8px; border-radius: 4px; font-size: 0.85em; background: #e0f7fa; color: #006064; font-family: monospace; }
        .empty-msg { text-align: center; color: #999; margin-top: 20px; }

        /* History Button Style */
        .btn-history {
            text-decoration: none;
            background-color: #95a5a6;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.85em;
            transition: 0.3s;
        }
        .btn-history:hover { background-color: #7f8c8d; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>üõ°Ô∏è Defense Industry Blockchain Network</h1>
        <p class="subtitle">CENG 3550 Final Project Dashboard</p>
    </header>

    <div class="actions-grid">
        <div class="card card-mint">
            <h2 style="color: #27ae60;">1. Mint New Weapon</h2>
            <form action="/mint" method="POST">
                <label>Serial Number:</label>
                <input type="text" name="serial" placeholder="Ex: TR-2025-001" required>
                <label>Weapon Model:</label>
                <input type="text" name="type" placeholder="Ex: MPT-76" required>
                <button type="submit" class="btn-mint">Register to Blockchain</button>
            </form>
        </div>

        <div class="card card-transfer">
            <h2 style="color: #2980b9;">2. Transfer Custody</h2>
            <form action="/transfer" method="POST">
                <label>Serial No to Transfer:</label>
                <input type="text" name="serial" placeholder="Enter an existing serial no" required>
                <label>New Owner:</label>
                <input type="text" value="Ganache Account (Auto Selected)" disabled style="background:#eee; color:#666;">
                <button type="submit" class="btn-transfer">Confirm Transfer</button>
            </form>
        </div>

        <div class="card card-maintenance">
            <h2 style="color: #f39c12;">3. Log Maintenance</h2>
            <form action="/maintenance" method="POST">
                <label>Serial Number:</label>
                <input type="text" name="serial" placeholder="Serial no of maintained weapon" required>
                <label>Description of Action:</label>
                <input type="text" name="description" placeholder="Ex: Barrel cleaning performed" required>
                <button type="submit" class="btn-maintenance">Log Maintenance</button>
            </form>
        </div>

        <div class="card card-report">
            <h2 style="color: #c0392b;">4. Report Lost/Stolen</h2>
            <form action="/report" method="POST">
                <label>Serial Number:</label>
                <input type="text" name="serial" placeholder="Weapon serial no" required>
                <label>New Status:</label>
                <select name="status">
                    <option value="1">Active / In Use</option>
                    <option value="3">Lost</option>
                    <option value="4">Stolen</option>
                    <option value="5">Scrapped</option>
                </select>
                <button type="submit" class="btn-report">Update Status</button>
            </form>
        </div>
    </div>

    <div class="inventory-section">
        <h2>üìã Current Weapon Inventory (Live Data)</h2>
        <p style="font-size: 0.9em; color: #666;">The data below is fetched directly from the blockchain.</p>

        <table>
            <thead>
                <tr>
                    <th>Serial No</th>
                    <th>Model / Type</th>
                    <th>Current Owner (Wallet Address)</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for weapon in weapons %}
                <tr>
                    <td style="font-weight: bold;">{{ weapon.serial }}</td>
                    <td>{{ weapon.type }}</td>
                    <td><span class="badge">{{ weapon.owner }}</span></td>
                    <td>
                        <a href="/history/{{ weapon.serial }}" class="btn-history">üìú View History</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if not weapons %}
        <div class="empty-msg">No weapons registered in the system yet.</div>
        {% endif %}
    </div>
</div>

</body>
</html>